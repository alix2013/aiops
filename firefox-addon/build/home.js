DEFAULT_AISERVER_URL="http://aiserver:5001";function getStorage(key){return new Promise((resolve,reject)=>{browser.storage.sync.get(key,result=>{if(browser.runtime.lastError){reject(browser.runtime.lastError)}else{resolve(result[key])}})})}document.addEventListener("DOMContentLoaded",function(){var input=document.getElementById("inputField");input.focus();var submitButton=document.getElementById("submitButton");var chatButton=document.getElementById("chatButton");input.addEventListener("keydown",function(event){if(event.key==="Enter"){event.preventDefault();submitButton.click()}});submitButton.addEventListener("click",submitForm);chatButton.addEventListener("click",openChat)});async function openChat(){chatServerUrl=await getStorage("CHATSERVER_URL");browser.tabs.create({url:chatServerUrl})}async function submitForm(){var submitButton=document.getElementById("submitButton");submitButton.disabled=true;submitButton.innerHTML='<i class="fa fa-spinner fa-spin"></i>';var inputValue=document.getElementById("inputField").value;responseTextArea.value="";serverUrl=await getStorage("AISERVER_URL");if(!serverUrl)serverUrl=DEFAULT_AISERVER_URL;console.log(serverUrl,serverUrl);fetch(serverUrl+"/ask",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({request:inputValue})}).then(function(response){if(response.ok){console.log(response);return response.json()}else{throw new Error("Error occurred while making the API request.")}}).then(function(responseData){var responseTextArea=document.getElementById("responseTextArea");responseTextArea.value=responseData.response}).catch(function(error){responseTextArea.value=error.message}).finally(function(){submitButton.disabled=false;submitButton.innerHTML="Submit"})}